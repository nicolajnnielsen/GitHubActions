on: push
name: Command via SSH
jobs:
  deploy:
    name: ðŸš€ Deploy Website Every Commit
    runs-on: ubuntu-latest
    steps:
    - name: ðŸšš Get latest code
      uses: actions/checkout@v2
      
    - name: Install SSH key
      uses: shimataro/ssh-key-action@v2
      with:
        key: ${{ secrets.SSH_KEY }}
        known_hosts: unnecessary
        
    - name: Adding Known Hosts
      run: ssh-keyscan -p ${{ secrets.SSH_PORT}} -H ${{ secrets.HOST }}  >> ~/.ssh/known_hosts
      
    - name: Deploy with Rsync
      run: sshpass -p ${{ secrets.FTP_PASSWORD }} rsync -e ssh --dry-run --archive --verbose --compress --delete-after --human-readable --exclude '.git' ./ ${{ secrets.USERNAME }}@linux287.unoeuro.com:~/test/
